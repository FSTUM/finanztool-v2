{% extends 'base.html' %}
{% load bootstrap5 %}

{% block title %}Finanztool - Personen{% endblock %}

{% block content %}
<h1>Personen</h1>

<div class="col-lg-6">
    <p>
        <a
            href="{% url "schluessel:add_key" %}"
            class="btn btn-info"
            role="button"
        >
            <span class="bi bi-plus-circle-fill"></span> Person hinzufügen
        </a>
    </p>

    <form
        id="filterform"
        method="POST"
        action=""
    >
        {% csrf_token %}

        {% bootstrap_form form %}
        <button
            type="submit"
            class="btn btn-secondary btn-info"
        >Suchen</button>
    </form>

    <table class="table table-striped table-hover">
        <tr>
            <th>Nachname</th>
            <th>Vorname</th>
            <th>E-Mail</th>
            <th>Schlüssel/Schließkarten</th>
        </tr>
        {% for person in persons %}
        <tr>
            <td>
                <a href="{% url "schluessel:view_person" person.id %}">{{ person.name }}</a>
            </td>
            <td>
                <a href="{% url "schluessel:view_person" person.id %}">{{ person.firstname }}</a>
            </td>
            <td>{{ person.email }}</td>
            <td>
                {% for key in person.key_set.all %}
                <a href="{% url "schluessel:view_key" key.id %}">{{ key }}</a>{% if not forloop.last %},
                {% endif %}
                {% endfor %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>


{% endblock %}
